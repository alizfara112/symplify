imports:
    - { resource: 'packages/EasyCodingStandard/config/psr2.yml' }
    - { resource: 'packages/EasyCodingStandard/config/php71.yml' }
    - { resource: 'packages/EasyCodingStandard/config/clean-code.yml' }
    - { resource: 'packages/EasyCodingStandard/config/symplify.yml' }
    - { resource: 'packages/EasyCodingStandard/config/common.yml' }

services:
    # class should be Abstact or Final
    SlamCsFixer\FinalInternalClassFixer: ~

    Symplify\CodingStandard\Fixer\Import\ImportNamespacedNameFixer:
        include_doc_blocks: true

    # code complexity
    PHP_CodeSniffer\Standards\Generic\Sniffs\Files\LineLengthSniff:
        absoluteLineLimit: 120
    PHP_CodeSniffer\Standards\Generic\Sniffs\Metrics\CyclomaticComplexitySniff:
        absoluteComplexity: 8
    PHP_CodeSniffer\Standards\Generic\Sniffs\Metrics\NestingLevelSniff:
        absoluteNestingLevel: 3

    Symplify\CodingStandard\Sniffs\DependencyInjection\NoClassInstantiationSniff:
        extraAllowedClasses:
            - 'Symplify\EasyCodingStandard\Error\Error'
            - 'Symplify\PackageBuilder\Reflection\*'
            - 'phpDocumentor\Reflection\Fqsen'
            - 'Symfony\Component\DependencyInjection\ContainerBuilder'
            - 'Symplify\EasyCodingStandard\Yaml\*'

    SlevomatCodingStandard\Sniffs\TypeHints\TypeHintDeclarationSniff:
        enableObjectTypeHint: false

    # php
    PhpCsFixer\Fixer\LanguageConstruct\FunctionToConstantFixer: ~
    # testing
    PhpCsFixer\Fixer\PhpUnit\PhpUnitSetUpTearDownVisibilityFixer: ~

parameters:
    skip:
        PHP_CodeSniffer\Standards\Generic\Sniffs\Files\LineLengthSniff:
            # many implemented interfaces
            - 'packages/CodingStandard/src/Fixer/Import/ImportNamespacedNameFixer.php'
            - 'packages/CodingStandard/src/Fixer/Commenting/RemoveUselessDocBlockFixer.php'

        SlevomatCodingStandard\Sniffs\TypeHints\TypeHintDeclarationSniff:
            - '*packages/CodingStandard/src/Sniffs/*/*Sniff.php'
            - 'packages/EasyCodingStandard/packages/SniffRunner/src/File/File.php'
            - 'packages/Statie/packages/FlatWhite/src/Latte/DynamicStringLoader.php'
            - 'packages/Statie/src/Configuration/Configuration.php'

        PhpCsFixer\Fixer\PhpUnit\PhpUnitStrictFixer:
            - 'packages/EasyCodingStandard/tests/Indentation/IndentationTest.php'

        Symplify\CodingStandard\Fixer\Php\ClassStringToClassConstantFixer:
            # name parts, not classes
            - 'packages/CodingStandard/src/Sniffs/DependencyInjection/NoClassInstantiationSniff.php'
            # "Exception" is string part of the name
            - 'packages/CodingStandard/src/Fixer/Naming/ExceptionNameFixer.php'
            - 'packages/CodingStandard/src/Fixer/Naming/ClassNameSuffixByParentFixer.php'
            # class might not exist
            - '*packages/EasyCodingStandard/src/DependencyInjection/CompilerPass/*CompilerPass.php'

        Symplify\CodingStandard\Sniffs\DependencyInjection\NoClassInstantiationSniff:
            # static helper
            - 'packages/PackageBuilder/src/Console/ExceptionRenderer.php'
            # temporary, remove with checkers autowire
            - 'packages/BetterReflectionDocBlock/src/FixedSerializer.php'
            # todo: decouple later
            - 'packages/TokenRunner/src/Wrapper/FixerWrapper/AbstractVariableWrapper.php'

        SlevomatCodingStandard\Sniffs\TypeHints\TypeHintDeclarationSniff.UselessDocComment: ~

        SlevomatCodingStandard\Sniffs\TypeHints\TypeHintDeclarationSniff.MissingParameterTypeHint:
            # respect param typehint
            - 'packages/TokenRunner/src/ReflectionDocBlock/Tag/TolerantParam.php'
            - 'packages/EasyCodingStandard/src/Yaml/CheckerTolerantYamlFileLoader.php'

        SlevomatCodingStandard\Sniffs\Exceptions\ReferenceThrowableOnlySniff.ReferencedGeneralException:
            # intentionally "Exception" value
            - 'packages/CodingStandard/src/Sniffs/Architecture/ExplicitExceptionSniff.php'
            # intentionally "Exception" value - 3rd party outdated typehint
            - 'packages/PackageBuilder/src/Console/ExceptionRenderer.php'

        Symplify\CodingStandard\Sniffs\CleanCode\ForbiddenStaticFunctionSniff:
            - 'packages/Statie/tests/SymfonyFileInfoFactory.php'
            - 'packages/PackageBuilder/src/Console/Command/CommandNaming.php'
            - 'packages/PackageBuilder/src/Configuration/ConfigFileFinder.php'
            - 'packages/PackageBuilder/src/Composer/VendorDirProvider.php'
            - 'packages/PackageBuilder/src/Composer/AutoloadFinder.php'
            - 'packages/EasyCodingStandard/src/Error/FileDiff.php'
            - 'packages/EasyCodingStandard/src/Error/Error.php'