# see https://github.com/marketplace/actions/deploy-to-github-pageshttps://github.com/marketplace/actions/deploy-to-github-pages
name: Build and Deploy

on:
    push:
        branches:
            - master

jobs:
    build-and-deploy:
        runs-on: ubuntu-latest
        steps:
            -
                name: Checkout
                uses: actions/checkout@v1

            -
                name: Install
                run:
                    composer install --no-progress

            -
                name: Split Monorepo
                run: |
                    # split monorepo to packages - only on merge to master
                    # see https://www.tomasvotruba.cz/blog/2018/07/19/how-to-make-github-and-travis-split-monorepo-to-multiple-git-repositories-for-you/
                    packages/MonorepoBuilder/bin/monorepo-builder split --max-processes 7
